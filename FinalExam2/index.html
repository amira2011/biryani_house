<!doctype html>
<html lang="en">

<head>
    <!-- Required meta tags -->
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="//code.jquery.com/ui/1.13.1/themes/base/jquery-ui.css">

    <title>Indian Rail </title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat&display=swap');

        * {
            font-size: 14px;
            font-family: 'Montserrat', sans-serif;
            
        }

        div {
            border: 1px solid;
        }

        .navbar-brand {
            font-weight: 600;

        }

        body {
            background-color: #d3d3d33b;
        }

        .logo {
            height: 25%;
            width: 25%;
            object-fit: contain;
        }
    </style>
</head>

<body>

    <nav class="navbar navbar-dark bg-dark">
        <div class="container">
            <a class="navbar-brand  " style="margin-left: 45px;" href="#">

                Indian Railways
            </a>
        </div>
    </nav>



    <div class="container ">
        <div class="row py-5">
            <div class="col-3 py-2">
                <div style="text-align: center;">
                    <img class="logo p-1" src="logo.png" />
                </div>
            </div>
            <div class="col-9 py-2">
                <div class="row p-1">
                    <div class="fw-bold">Search Trains</div>
                    <div class="p-1 d-inline-flex  " style="font-size: 12px;">

                        <div><input type="text" id="station1" placeholder="Station Name"></div>
                        <div style="padding-left: 15px;"> <input type="text" id="station2" placeholder="Station Name">
                        </div>

                        <div style="padding-left: 15px;"> <input type="text" class="date-pick" id="datepicker"
                                placeholder="Date"></div>
                        <div style="padding-left: 15px;"> <button type="button" id="searchTrains" class="btn btn-primary">Search</button></div>
                    </div>
                </div>
            </div>
        </div>

        <div>
            <button type="button" class="btn btn-primary">Search</button>
        </div>

        <!-- Jquery JS -->
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>

        <!-- Bootstrap JS -->
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

        <script src="https://code.jquery.com/ui/1.13.1/jquery-ui.js"></script>
        <script>
            $(document).ready(function () {

                
                var station1_data = [];
                var station2_data = [];
                var date;
                var meta_data=[];

                $("#station1").autocomplete({
                    minLength: 3,
                    source: function (request, response) {
                        var term = request.term;

                         
                        $.ajax({

                            url: `https://indianrailapi.com/api/v2/AutoCompleteStation/apikey/c9b14556386b178bd3170c2a8d2196d7/StationCodeOrName/${term}`,


                            type: "GET",

                            success: function (data) {

                                station1_data = []
                                //{ label: "Choice1", value: "value1" }
                                for (let i = 0; i < data.Station.length; i++) {
                                    station1_data.push({
                                        label: data.Station[i].NameEn,
                                        value: data.Station[i].StationCode
                                    })
                                    
                                    // station_data.push({ "label": data.Station[i].NameEn, "value": data.Station[i].StationCode })
                                }
                                  //console.log('ok', station1_data)
                                response(station1_data);
                            }

                        })
                        
                    }

                });
                 



                $("#station2").autocomplete({
                    minLength: 3,
                    source: function (request, response) {
                        var term = request.term;

                         
                        $.ajax({

                            url: `https://indianrailapi.com/api/v2/AutoCompleteStation/apikey/c9b14556386b178bd3170c2a8d2196d7/StationCodeOrName/${term}`,


                            type: "GET",

                            success: function (data) {

                                station2_data = []
                                //{ label: "Choice1", value: "value1" }
                                for (let i = 0; i < data.Station.length; i++) {
                                    station2_data.push({
                                        label: data.Station[i].NameEn,
                                        value: data.Station[i].StationCode
                                    })
                                    
                                    // station_data.push({ "label": data.Station[i].NameEn, "value": data.Station[i].StationCode })
                                }
                             //     console.log('ok', station2_data)
                                response(station2_data);
                            }

                        })
                        
                    }

                });
                 






                $('.date-pick').datepicker({
                    onSelect: function (date) {
                        date = date
                       // console.log(date)
                    },

                    inline: true,

                });



                $('#searchTrains').click(function (e) {
                e.preventDefault();
                fetch_data();
            });

 


            function fetch_data() {
                    let fromStationCd=$('#station1').val()
                    let toStationCd=$('#station2').val()
                    let dt=$('#datepicker').val()
                    let x=dt.split("/")
                    x=`${x[2]}${x[0]}${x[1]}`
                 
                   let url1=`https://indianrailapi.com/api/v2/SeatAvailability/apikey/c9b14556386b178bd3170c2a8d2196d7/From/${fromStationCd}/To/${toStationCd}/Date/${x}/Server/1/Route/1/`
                   

                    $.ajax({
                    url: url1,
                    type: "GET",
                    success: function (data) {
                                           
                       meta_data = data.Trains;
                       
                       let total_records = data.TotalTrains;
                        console.log( meta_data)
                       /*
                        $.each(meta_data, function (idx, movie) {
                            my_table_data.push({ 'original_title': movie.original_title, 'release_date': movie.release_date, 'vote_average': movie.vote_average, 'popularity': movie.popularity, 'id': idx })
                        })


                        buildTable(my_table_data)

                        pagination()

                        progress_bar()

*/


                    }



                });





            }


                 


            })
        </script>

</body>

</html>